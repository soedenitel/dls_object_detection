# Продуктовый трек
## 1. Поиск проблемы и описание решения (2 балла)
В этом пункте необходимо сформулировать проблему реального мира и продумать, как именно она будет решаться с помощью вашего продукта. 

### Существующая проблема:
* по всей территории ЖК расставлены камеры видеонаблюдения, сигнал от которых выведен на видеопульт в специальном помещении на экран;
* для мониторинга разных участков дежурный видеопульта вручную последовательно переключает экран на камеры разных участков и визуально контроллирует обстановку на территории;
* в кажом подъезде всех зданий ЖК есть консьержи, предназначенные для физического взаимодействия со средой (с людьми и объектам в своей зоне) - это возможность взаимодействия со всей территоией ЖК со стороны оперативных сотрудников управляющей компании (УК);
* УК должна контролировать исполнение запрета (принятого на ОСС собственников) выгула собак на территории ЖК, но не справляется с этим;
* жильцы регулярно находят на территории ЖК собачьи экскременты, от этого портится газон, идёт поток жалоб на работу УК;
* дежурный видеопульта пропускает выгул собак жильцами ЖК и их гостями по причине того, что большую часть времени ничего не происходит, внимание притупляется, мотивация переключаться на камеры "на которых ничего не происходит" снижается;
* консьержи сидят в лобби внутри подъездов и исполняют мелкие поручения жильцов, отслеживать ситуацию вокруг своего подъезда им не позволяет расположение их рабочего места, они не видят приподъездную территорию;
* если консьерж регулярно покидает подъезд с целью обхода своей приподъездной территории, это вызывает поток жалоб со стороны жильцов на якобы отсутствующего на рабочем месте консьержа и создаёт предпосылки для злоупотреблений со стороны консьержей (невозможно гарантировать, что консьерж отсутствует из-за наличия дел на территории, а не по причине частых перекуров).

### Целевая аудитория:
* Службы видеомониторинга территорий управляющих компаний ЖКХ и организации, осуществляющие охрану территорий.

3. **Ваш продукт должен быть оформлен в сервис, подходящий для основного сценария использования продукта и целевой аудитории**. Предположим, например, что вы делаете цифровой сервис для распознавания языка жестов. Как может выглядеть такой продукт и в какой сервис он может быть внедрён? Например, если создать ТГ-бота, который будет детектировать и распознавать жест по фотографии, его довольно сложно будет использовать, потому что каждый жест в отдельности сфотографировать нельзя. Оптимальным решением в этом случае было бы мобильное приложение с потоковым детектированием жеста на видео и автоматическим добавлением субтитров. При этом именно такой продукт может быть слишком сложен в реализации. Тогда необходимо выбрать оформление сервиса, которое будет осмысленно с продуктовой точки зрения и которое вы при этом сможете реализовать.

### Предлагаемое решение:
* программное обеспечение видеопульта в автоматическом режиме раз в 3 секунды делает снимки со всех камер на территории жк и отправляет для каждого снимка запрос на http-запрос;
* сервис обрабатывает картинку в рамках http-запроса, детектирует наличие на картинке собак и отправляет ответ видеопульту охраны;
* в случае наличия собак или кошек, видеопульт выводит на экран дежурного и консьержа (соответствующего подъезда) индикацию и включает звуковую сигнализацию;
* обязанность консьержа, получившего сигнал, выйти на территорию и вежливо попросить убрать собаку или кошку с территории.

#### Варианты использования сервиса в рамках имеющейса программно-организационной структуры.
##### Сервис (подсистема), разрабатываемая в рамках данного проекта
![](01.png)
Рисунок 1. Диаграма использования, разрабатываемого сервиса

##### Уже имеющиеся подсистема видеонаблюдения и варианты её использования с новым функционалом
![](02.png)
Рисунок 2. Диаграма использования старой системы видеонаблюдения с новым функционалом

#### Синтаксис API для использования разрабатываемого сервиса:
- авторизоваться в сервисе:
<ul>
    <li>post-запрос <b>http://host:port/login</b></li>
    <li>
        параметры в теле запроса, формат json:
        <pre>
        {
            "login": "dls",
            "password": "dls"
        }
        </pre>
    </li>
</ul>
- получить результаты детекции в формате графической разметки на исходном изображении:
<ul>
    <li>post-запрос <b>http://host:port/detect_to_jpeg</b></li>
    <li>в качестве параметра запроса передаётся файл картинки из формы (см пример html-формы в исходных кодах)</li>
    <li>в качестве ответа на запрос приходит либо картинка с разметкой детектированных бъектов, либо текст json (если детектировать не удалось)</li>
</ul>
- получить результаты детекции в json-формате:
<ul>
    <li>post-запрос <b>http://host:port/detect_to_jpeg</b></li>
    <li>в качестве параметра запроса передаётся файл картинки из формы (см пример html-формы в исходных кодах)</li>
    <li>
        в качестве ответа на запрос приходит json (ниже пример, для случая удавшейся детекции):
        <pre>
        {
            "status": "ok",
            "data": {
                "boxes": [
                    [
                        75.01468658447266,
                        292.328369140625,
                        164.70286560058594,
                        544.2100830078125
                    ],
                    [
                        481.8454895019531,
                        363.0608215332031,
                        545.259521484375,
                        473.8014831542969
                    ]
                ],
                "labels": [
                    "dog",
                    "dog"
                ],
                "probabilities": [
                    0.9992601275444031,
                    0.974423348903656
                ]
            }
        }
        </pre>
    </li>
</ul>

## 2. Поиск обученной модели и датасета (1 балл)
Выбрана готовая модель **fasterrcnn_resnet50_fpn_v2** из стандартного пакета torchvision.models.detection с набором весов **FasterRCNN_ResNet50_FPN_V2_Weights.DEFAULT** обученных на датасете **COCO**.

Тестирование показало, что данная модель успешно справляется со своими задачами в сформулированных выше вариантах использования и легко встраивается - этим и обусловлен выбор.

### Примеры результатов работы данной модели в составе разработанного сервиса
![](test_result_images/000.jpeg)
Рисунок 3. Пример результата работы модели

![](test_result_images/002.jpeg)
Рисунок 4. Пример результата работы модели

![](test_result_images/003.jpeg)
Рисунок 5. Пример результата работы модели

![](test_result_images/004.jpeg)
Рисунок 6. Пример результата работы модели

![](test_result_images/005.jpeg)
Рисунок 7. Пример результата работы модели

![](test_result_images/006.jpeg)
Рисунок 8. Пример результата работы модели

![](test_result_images/008.jpeg)
Рисунок 9. Пример результата работы модели

## 3. Выбор фреймворка/библиотеки для разработки веб/мобильного демо (0 баллов)

В качестве фреймворка для разработки мобильного демо выбрана библиотека [**AIOHTTP**](https://docs.aiohttp.org) — это асинхронный HTTP-клиент/сервер для модуля [asyncio](https://docs.python.org/3/library/asyncio.html).